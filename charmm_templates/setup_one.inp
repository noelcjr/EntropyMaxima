* Auto-generated CHARMM script.
*

! CHARMM input generated by charmm_setup.prl
! ==========================================
! Read in topology and parameter files
! ====================================

open read unit 1 card name "/code/em/params/charmm27.ff/top_all27_prot_na.rtf"
read rtf card unit 1
close unit 1

open read unit 2 card name "/code/em/params/charmm27.ff/par_all27_prot_na.prm"
read para card unit 2
close unit 2

!stream "/code/em/params/charmm27.ff/radii_prot_na_dfg.str"

open read unit 1 card name A.SEQ
read sequence unit 1 card
close unit 1
generate A first none last none setup
stream "A_FIXRES.INP"

open read unit 1 card name B.SEQ
read sequence unit 1 card
close unit 1
generate B first none last none setup
stream "B_FIXRES.INP"

!patch disu A 6 A 11 setup sort warn
!patch disu A 7 B 7 sort warn
!patch disu A 20 B 19 sort warn

scalar wmain = charge

open write unit 1 card name OUTFILE.psf
write psf card unit 1

open write unit 1 card name OUTFILE.ic
write ic card unit 1

open read unit 1 card name INFILE.crd
read coor card unit 1 resid
close unit 1

! Check for and build in missing heavy atoms
! Build is done into default geometry from parameter file.
! ==========================================

define missing1 sele .not. ( init .or. hydrogen ) end
if ?nsel ne 0 print coor sele .not. ( init .or. hydrogen ) end

ic param
ic fill preserve
ic build

define missing2 sele .not. ( init .or. hydrogen ) end
if ?nsel ne 0 print coor sele .not. ( init .or. hydrogen ) end

! Build hydrogens
! Default parameters are rdiel of 4, with no cutoffs.
! ===================================================

hbuild sele hydrogen end -
elec atom rdiel switch eps 2 -
vdw vatom vswitch -
cutnb 999 ctofnb 998 ctonnb 997 wmin 1.5 -
e14fac 1 nbxmod 5

hbuild sele hydrogen end -
elec atom rdiel switch eps 2 -
vdw vatom vswitch -
cutnb 999 ctofnb 998 ctonnb 997 wmin 1.5 -
e14fac 1 nbxmod 5

update

! Write out structure, ic table and coordinates.
! ==============================================

scalar wmain = charge

open write unit 1 card name OUTFILE.crd
write coor card unit 1

open write unit 1 card name OUTFILE.pdb
write coor pdb unit 1

write psf card xplo name OUTFILE_xplor.psf

stop

! End generated CHARMM input
! ==========================
