* Auto-generated CHARMM script.
*

! CHARMM input generated by charmm_setup.prl 
! ========================================== 
! Read in topology and parameter files
! ====================================
open read unit 1 card name "/code/em/params/charmm27.ff/top_all27_prot_na.rtf"
read rtf card unit 1
close unit 1

open read unit 2 card name "/code/em/params/charmm27.ff/par_all27_prot_na.prm"
read para card unit 2
close unit 2

!stream "/code/em/params/charmm27.ff/radii_prot_na_dfg.str"

open read unit 1 card name A.SEQ
read sequence unit 1 card
close unit 1
generate A first none last CTER setup 
stream "A_FIXRES.INP"

open read unit 1 card name B.SEQ
read sequence unit 1 card
close unit 1
generate B first none last CTER setup
stream "B_FIXRES.INP"

!patch disu A 6 A 11 setup sort warn
!patch disu A 7 B 7 sort warn
!patch disu A 20 B 19 sort warn

scalar wmain = charge

set j 1
label loop

open write unit 1 card name 2hiu_linker2_@jrr.psf
write psf card unit 1

open write unit 1 card name 2hiu_linker2_@jrr.ic
write ic card unit 1

open read unit 1 card name 2hiu_linker2_@jr.crd
read coor card unit 1 resid
close unit 1

! Check for and build in missing heavy atoms
! Build is done into default geometry from parameter file.
! ==========================================

define missing1 sele .not. ( init .or. hydrogen ) end
if ?nsel ne 0 print coor sele .not. ( init .or. hydrogen ) end

ic param
ic fill preserve
ic build

define missing2 sele .not. ( init .or. hydrogen ) end
if ?nsel ne 0 print coor sele .not. ( init .or. hydrogen ) end

! Build hydrogens
! Default parameters are rdiel of 4, with no cutoffs.
! ===================================================

hbuild sele hydrogen end -
  elec atom rdiel switch eps 2 -
  vdw vatom vswitch -
  cutnb 999 ctofnb 998 ctonnb 997 wmin 1.5 -
  e14fac 1 nbxmod 5

hbuild sele hydrogen end -
  elec atom rdiel switch eps 2 -
  vdw vatom vswitch -
  cutnb 999 ctofnb 998 ctonnb 997 wmin 1.5 -
  e14fac 1 nbxmod 5

update

! Write out structure, ic table and coordinates.
! ==============================================

scalar wmain = charge

open write unit 1 card name 2hiu_linker2_@jrr.crd
write coor card unit 1

open write unit 1 card name 2hiu_linker2_@jrr.pdb
write coor pdb unit 1

write psf card xplo name 2hiu_linker2_@jrr_xplo.psf
incr j by 1
if j le 10 goto loop

stop

! End generated CHARMM input
! ==========================
